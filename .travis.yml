language: cpp
sudo: false

matrix:
  fast_finish: true
  include:  
  - os: linux
    env:
      - TEST="Clang format"
    script:
      - |
        if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then
          mkdir build
          cd build
          cmake -DRINGMESH_WITH_GRAPHICS:BOOL=ON -DRINGMESH_WITH_UTILITIES:BOOL=ON -DRINGMESH_WITH_TESTS:BOOL=ON -DRINGMESH_WITH_TUTORIALS:BOOL=ON ..
          cd ringmesh/Release
          make format
          if [[ -n $(git diff) ]]; then
            echo "Format requirement is not satisfied"
            return 1
          fi
        fi
    after_failure:
      - $TRAVIS_BUILD_DIR/tools/travis-ci-git-commit.bash
  - os: linux
    env:
      - TEST="Gcc Check"
    script:
      - mkdir build
      - cd build
      - CXX=/usr/bin/g++ CC=/usr/bin/gcc cmake -DRINGMESH_WITH_GRAPHICS:BOOL=OFF -DRINGMESH_WITH_UTILITIES:BOOL=ON -DRINGMESH_WITH_TESTS:BOOL=ON -DRINGMESH_WITH_TUTORIALS:BOOL=ON ..
      - cd ringmesh/Debug
      - cmake --build .
      - ctest
      
