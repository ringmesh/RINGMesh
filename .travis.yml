language: cpp
sudo: false

env:
  - secure: "UMjXB5blIs09eiB8tyxRUKhxnkrb8Xsw9R92XT0V9As4iA+nHpgGF8sj2/cm+cS7j8poySPQHjZ9HibzcE+Rwoa3GaVd1LecUUaWtNCoil+mFc8cYhNHkcAu/I0N6ocF7rzo7xvWSY1AGArIxE+jihQvMBfwjaQcyK55HJuREyri3vhQr/VWGEVmR9qBbWwDU7SPCidLcmBdpYOPkoAf9d9LLt7/zuHZiIQkVCXbzwjj8JEM5UliE2quA5sLi1wfXeD7yijZK0QtOz0L2ROnBvMaR49cDsO1ex3t6QuXmpBSp2PaQ0Rd+fIi/tKcTEgF6AgSrx7DMZxBbYl6emopfhdWgjbF7UiqXB86ygawtWe94f9zc4AM+Q78OloNVr4mgsFmnFiygsPErBq0XGSl4HRyUBgBQbzU7tV/JouuGeebNZ3pZuWlmP3CNTENL2whE5IHBEKg28xJxKBRMaqLaWisdcHMRhsnh8eU9IN8/85pie+oEybvIaZSWtwc6WJzQ08Olsqynh6DjI+nlBlPMnhqXy7qQEh6/miEAgRhF1vW/KzjRZhuRF8rR2pbLxDaBwxGujWP5j87DzhE41dbmG0Y1JqAW5PbZ7puR3WQ3As7fTN4BDQ5I87dhdE/cxrkvMN6GyVdMRRw7S45Znlz+PTZWRRhA+Xz4xK2rdJ71Gg="

matrix:
  fast_finish: true
  include:  
  - os: linux
    env:
      - TEST="Clang format"
    script:
      - |
        if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then
          mkdir build
          cd build
          cmake -DRINGMESH_WITH_GRAPHICS:BOOL=ON -DRINGMESH_WITH_UTILITIES:BOOL=ON -DRINGMESH_WITH_TESTS:BOOL=ON -DRINGMESH_WITH_TUTORIALS:BOOL=ON ..
          cd ringmesh/Release
          make format
          if [[ -n $(git diff) ]]; then
            echo "Format requirement is not satisfied"
            return 1
          fi
        fi
    after_failure:
      - $TRAVIS_BUILD_DIR/tools/travis-ci-git-commit.bash
  - os: linux
    env:
      - TEST="Gcc Check"
    script:
      - mkdir build
      - cd build
      - CXX=/usr/bin/g++ CC=/usr/bin/gcc cmake -DRINGMESH_WITH_GRAPHICS:BOOL=OFF -DRINGMESH_WITH_UTILITIES:BOOL=ON -DRINGMESH_WITH_TESTS:BOOL=ON -DRINGMESH_WITH_TUTORIALS:BOOL=ON ..
      - cd ringmesh/Debug
      - cmake --build .
      - ctest
      
